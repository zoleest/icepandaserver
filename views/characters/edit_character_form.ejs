<!DOCTYPE html>
<html>
<%- include('../partials/head'); %>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="col-12 col-lg-6 p-3 bg-light bg-opacity-75">
            <h2 class="text-danger"><%=errorText!==undefined?errorText:""%></h2>
            <form method="POST">
                <label for="name"><%= language.characters.name %>:</label><input class="form-control mb-2" id="name"
                                                                                 name="name"
                                                                                 placeholder="<%= language.characters.namePlaceholder %>" value="<%=oldProfile!==undefined?oldProfile.character_name:""%>"
                                                                                 required >
                <label for="nickname"><%= language.characters.nickname %>:</label><input class="form-control mb-2"
                                                                                         id="nickname" name="nickname"
                                                                                         placeholder="<%= language.characters.nicknamePlaceholder %>" value="<%=oldProfile!==undefined?oldProfile.character_nicknames:""%>"
                                                                                         required>
                <label for="birthday"><%= language.characters.birthday %>:</label><input class="form-control mb-2"
                                                                                         id="birthday" type="date"
                                                                                         name="birthday"  value="<%=oldProfile!==undefined?oldProfile.character_birthday_date:""%>" required >
                <label for="species"><%= language.characters.species %>:</label><input class="form-control mb-2"
                                                                                       name="species" id="species"
                                                                                       placeholder="<%= language.characters.speciesPlaceholder %>" value="<%=oldProfile!==undefined?oldProfile.character_species:""%>"
                                                                                       required>
                <label for="sexuality"><%= language.characters.sexuality %>:</label><select class="form-select mb-2"
                                                                                            id="sexuality"
                                                                                            name="sexuality">
                    <option <%=oldProfile===undefined?"selected":""%> hidden disabled><%= language.characters.sexualityPlaceholder %> </option>
                    <option value="<%= language.characters.sexualityHeterosexual %>" <%=(oldProfile!==undefined&& oldProfile.sexuality===language.characters.sexualityHeterosexual)?"selected":""%>><%= language.characters.sexualityHeterosexual %></option>
                    <option value="<%= language.characters.sexualityHomosexual %>" <%=(oldProfile!==undefined&& oldProfile.sexuality===language.characters.sexualityHomosexual)?"selected":""%>><%= language.characters.sexualityHomosexual %></option>
                    <option value="<%= language.characters.sexualityAsexual %>" <%=(oldProfile!==undefined&& oldProfile.sexuality===language.characters.sexualityAsexual)?"selected":""%>><%= language.characters.sexualityAsexual %></option>
                    <option value="<%= language.characters.sexualityBisexual %>" <%=(oldProfile!==undefined&& oldProfile.sexuality===language.characters.sexualityBisexual)?"selected":""%>><%= language.characters.sexualityBisexual %></option>
                    <option value="<%= language.characters.sexualityOther %>" <%=(oldProfile!==undefined&& oldProfile.sexuality===language.characters.sexualityOther)?"selected":""%>><%= language.characters.sexualityOther %></option>
                </select>
                <label for="sex"><%= language.characters.sex %>:</label><select class="form-select mb-2" name="sex"
                                                                                id="sex">
                    <option <%=oldProfile===undefined?"selected":""%>  hidden disabled><%= language.characters.sexPlaceholder %></option>
                    <option value="<%= language.characters.sexMale %>" <%=(oldProfile!==undefined&& oldProfile.sex===language.characters.sexMale)?"selected":""%>><%= language.characters.sexMale %></option>
                    <option value="<%= language.characters.sexFemale %>" <%=(oldProfile!==undefined&& oldProfile.sexy===language.characters.sexFemale)?"selected":""%>><%= language.characters.sexFemale %></option>
                </select>


                <button type="button" id="change_image" style="display:none">Másik kép válaszása</button>
                <label for="profile_picture_file" ><%= language.characters.profilePic %></label><input
                        class="form-control" type="file" id="profile_picture_file" required>
                <input type="hidden" name="profile_picture" id="profile_picture">


                <div class="weapons bg-dark bg-opacity-25 p-3 rounded mt-3">
                    <%= language.characters.weapons %>:<br>


                    <% for (let weaponsIteral = 0; weaponsIteral < 6; weaponsIteral++){%>


                        <label class="mt-2 weapon-label <%=oldProfile.character_weapons[weaponsIteral]!==undefined?"":"d-none"%>"><%- language.characters.fieldName %>:</label><input
                                name="weapon_name" class="form-control mt-1 mb-2 d-inline-block <%=oldProfile.character_weapons[weaponsIteral]!==undefined?"":"d-none"%>" value="<%=oldProfile.character_weapons[weaponsIteral]!==undefined?oldProfile.character_weapons[weaponsIteral].weapon_name:""%>"><textarea class="d-none"
                                                                                                                                                                                                                   name="weapon_description"
                                                                                                                                                                                                                   id="weapon_description_0"><%=oldProfile.character_weapons[weaponsIteral]!==undefined?oldProfile.character_weapons[weaponsIteral].weapon_description:""%></textarea>

                    <%}%>

                   <div class="text-center">
                        <button class="btn w-100 btn-success mt-2" type="button" onClick="unhide('weapon');"
                                id="new_weapon">+
                        </button>
                    </div>
                </div>
                <div class="weapons bg-dark bg-opacity-25 p-3 rounded mt-3">
                    <%= language.characters.abilities %>:<br>


                <% for (let abilitiesIteral = 0; abilitiesIteral < 6; abilitiesIteral++){%>


                <label class="mt-2 ability-label <%=oldProfile.character_abilities[abilitiesIteral]!==undefined?"":"d-none"%>"><%- language.characters.fieldName %>:</label><input
                        name="ability_name" class="form-control mt-1 mb-2 d-inline-block <%=oldProfile.character_abilities[abilitiesIteral]!==undefined?"":"d-none"%>" value="<%=oldProfile.character_abilities[abilitiesIteral]!==undefined?oldProfile.character_abilities[abilitiesIteral].ability_name:""%>"><textarea class="d-none"
                                                                                                                                                                                                                                                                                                            name="ability_description"
                                                                                                                                                                                                                                                                                                            id="ability_description_0"><%=oldProfile.character_abilities[abilitiesIteral]!==undefined?oldProfile.character_abilities[abilitiesIteral].ability_description:""%></textarea>

                <%}%>     
                <div class="text-center">
                        <button class="btn w-100 btn-success mt-2" type="button" onClick="unhide('ability');"
                                id="new_ability">+
                        </button>
                    </div>
                </div>
                <label class="mt-2"><%= language.characters.story %></label>: <textarea name="story" id="story"><%=oldProfile!==undefined?oldProfile.character_story:""%></textarea><br>
                <label class="mt-2"><%= language.characters.interests %></label>: <textarea name="interests" id="interests"><%=oldProfile!==undefined?oldProfile.character_interests:""%></textarea><br>
                <input type="submit" id="submit_button" class="btn btn-success">
            </form>
        </div>
        <div class="col-lg-6 d-none d-lg-block bg-dark text-light pt-3">
            <h1 id="profile_name" class="text-center"></h1>
            <div id="croppie-container">
                <img id="profile_picture_image">
            </div>
            <button class="btn btn-warning w-100 d-none" id="use">Körbevágás</button>



            <h2 class="mt-3 text-info"><%= language.characters.nickname %>:</h2>
            <p class="h4" id="profile_nickname"></p>
            <h2 class="mt-3 text-info"><%= language.characters.birthday %>:</h2>
            <p class="h4"  id="profile_birthday"></p>
            <h2 class="mt-3 text-info"><%= language.characters.species %>:</h2>
            <p class="h4"  id="profile_species"></p>
            <h2 class="mt-3 text-info">  <%= language.characters.sexuality %>:</h2>
            <p class="h4"  id="profile_sexuality"></p>
            <h2 class="mt-3 text-info"><%= language.characters.sex %>:</h2>
            <p class="h4"  id="profile_sex"></p>
            <h2 class="mt-3 text-info"> <%= language.characters.weapons %>:</h3>
            <p id="profile_weapons"></p>
            <h2 class="mt-3 text-info"> <%= language.characters.abilities %>:</h2>
            <p id="profile_abilities"></p>
            <h2 class="mt-3 text-info"><%= language.characters.story %>:</h2>
            <p class="h4" class="h4" id="profile_story"></p>
            <h2 class="mt-3 text-info"><%= language.characters.interests %>:</h2>
            <p class="h4" class="h4" id="profile_interests"></p>

        </div>
    </div>
</div>
</body>


<script src="/javascripts/character_edit.js"></script>

<style>
    <%
    for(let weaponsIteral = 2; weaponsIteral <= oldProfile.character_weapons.length; weaponsIteral++){
        %>
    div[class^='cke_editor_weapon_description']:nth-of-type(<%=weaponsIteral %>), div[class*='cke_editor_weapon_description']:nth-of-type(<%=weaponsIteral %>) {
        display: block;
    }
    <% } %>

    <%
    for(let abilitiesIteral = 2; abilitiesIteral <= oldProfile.character_abilities.length; abilitiesIteral++){
        %>
    div[class^='cke_editor_ability_description']:nth-of-type(<%=abilitiesIteral %>), div[class*='cke_editor_ability_description']:nth-of-type(<%=abilitiesIteral %>) {
        display: block;
    }
    <% } %>
</style>

<script>

    updateProfileFields(false);

    <%if(oldProfile !== undefined) { %>

    visibleWeapons = <%=oldProfile.character_weapons.length%>;
    visibleAbilities= <%=oldProfile.character_abilities.length%>;




    <% }%>

</script>
